<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>A Brief Intro to Tidyverse</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style>
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="avenir-white.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">A Brief Intro to Tidyverse</h1>
</header>
<p><strong>Note</strong>: Before you begin, make sure to <code>git pull</code> this repository to bring your local repo up to date with the online one.</p>
<p><br><br></p>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><p><a href="#tidyverse-packages-and-installation">1. Tidyverse Packages and Installation</a></p></li>
<li><p><a href="#data-sets">2. Data Sets</a></p></li>
<li><p><a href="#importing-data-into-r">3. Importing Data into R</a></p>
<ul>
<li><p><a href="#clone-nyt-covid-data">3.1 Clone NYT COVID Data</a></p></li>
<li><p><a href="#import-college-cases-data">3.2 Import College Cases Data</a></p></li>
</ul></li>
<li><p><a href="#exploring-data">4. Exploring Data</a></p>
<ul>
<li><p><a href="#using-pipes">4.1 Using Pipes (<code>%&gt;%</code>)</a></p></li>
<li><p><a href="#accessing-specific-data-from-tibbles">4.2 Accessing Specific Data from Tibbles</a></p></li>
<li><p><a href="#exploratory-visualization">4.3 Exploratory Visualization</a></p></li>
<li><p><a href="#exercises">4.4 Exercises</a></p></li>
<li><p><a href="#visualizing-data-on-maps">4.5 Visualizing Data on Maps</a></p></li>
</ul></li>
</ul>
<p><Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br> <Br><br><br><br></p>
<h2 id="tidyverse-packages-and-installation">1. Tidyverse Packages and Installation</h2>
<ul>
<li><p>We will be working with many of the following packages in this session:</p>
<ul>
<li><p><code>readr</code>: Efficiently import data into R</p></li>
<li><p><code>tibble</code>: The spreadsheet workhose of Tidyverse</p></li>
<li><p><code>dplyr</code>: Data manipulation</p></li>
<li><p><code>tidyr</code>: Tidy your data</p></li>
<li><p><code>ggplot2</code>: A different grammar of graphics</p></li>
<li><p><code>forcats</code>: Simplify factors</p></li>
<li><p><code>purrr</code>: Repetitive tasks</p></li>
</ul></li>
<li><p>While you can install them one package at a time, you can also install all at once:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;hadley/tidyverse&quot;</span>)</span></code></pre></div></li>
</ul>
<p><br><br><br></p>
<h2 id="data-sets">2. Data Sets</h2>
<ul>
<li><p>Example data sets included with packages tend to be generally not from biology. For today’s exercises, we will be using many of the following data sets instead. All data sets are now part of this repository, which you can access by doing <code>git pull</code>.</p>
<ul>
<li><p>NYT COVID-19 Datasets</p></li>
<li></li>
</ul></li>
</ul>
<p><br><br><br></p>
<h2 id="importing-data-into-r">3. Importing Data into R</h2>
<ul>
<li><p><a href="https://tidyverse.org">Tidyverse</a> package <a href="https://readr.tidyverse.org">readr</a> has an improved set of functions over their base-R counterparts. These functions are a lot faster, which is advantageous when reading very large data sets. For such large files, readr functions have a progress bar showing the amount of data read in real time. In base-R, you are just waiting for the prompt to return.</p>
<ul>
<li><p><code>read_csv</code> (base-R: <code>read.csv</code>)</p></li>
<li><p><code>read_tsv</code> (base-R: <code>read.table</code>)</p></li>
<li><p><code>read_delim</code> (base-R: <code>read_delim</code>)</p></li>
<li><p><code>read_log</code> (no base-R function)</p></li>
</ul></li>
<li><p>When you read in a data frame (i.e. a spreadsheet), with any type of column delimiter (comma, tab, space or some other symbol), readr converts it into a format called <code>tibble</code>, which is a modified data frame. A <code>tibble</code> provides many ease of use features as we will see below.</p></li>
</ul>
<h3 id="clone-nyt-covid-data">3.1 Clone NYT COVID Data</h3>
<ul>
<li>Use the <code>git clone</code> function on <a href="https://github.com/nytimes/covid-19-data">github.com/nytimes/covid-19-data</a> to make a local copy.</li>
</ul>
<p><br><br></p>
<h3 id="import-college-cases-data">3.2 Import college cases data</h3>
<ul>
<li>Once you clone the above repository, take a look at the contents. We are going to use data inside the <code>colleges</code> folder.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="bu">cd</span> covid-19-data/</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">ls</span> -lh</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="ex">-rw-r--r--@</span> 1 vikram  staff   1.3K Feb 24 06:41 LICENSE</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="ex">-rw-r--r--@</span> 1 vikram  staff   2.7K Feb 24 06:41 NEW-YORK-DEATHS-METHODOLOGY.md</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="ex">-rw-r--r--@</span> 1 vikram  staff   3.1K Feb 24 06:41 PROBABLE-CASES-NOTE.md</span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="ex">-rw-r--r--@</span> 1 vikram  staff    21K Jun  7 18:28 README.md</span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="ex">drwxr-xr-x@</span> 4 vikram  staff   128B Jun  7 18:28 colleges</span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="ex">drwxr-xr-x@</span> 4 vikram  staff   128B Feb 24 06:41 excess-deaths</span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="ex">drwxr-xr-x@</span> 5 vikram  staff   160B Jun  7 18:28 live</span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="ex">drwxr-xr-x@</span> 4 vikram  staff   128B Feb 24 06:41 mask-use</span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="ex">drwxr-xr-x@</span> 5 vikram  staff   160B Jun  7 18:28 prisons</span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="ex">drwxr-xr-x@</span> 8 vikram  staff   256B Jun  7 18:28 rolling-averages</span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="ex">-rw-r--r--@</span> 1 vikram  staff   3.9M Jun  7 18:28 us-counties-recent.csv</span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="ex">-rw-r--r--@</span> 1 vikram  staff    55M Jun  7 18:28 us-counties.csv</span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="ex">-rw-r--r--@</span> 1 vikram  staff   855K Jun  7 18:28 us-states.csv</span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="ex">-rw-r--r--@</span> 1 vikram  staff    12K Jun  7 18:28 us.csv</span>
<span id="cb2-20"><a href="#cb2-20"></a></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="bu">cd</span> colleges</span>
<span id="cb2-22"><a href="#cb2-22"></a></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="fu">ls</span> -lh</span>
<span id="cb2-24"><a href="#cb2-24"></a></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="ex">-rw-r--r--@</span> 1 vikram  staff   6.6K Jun  7 18:28 README.md</span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="ex">-rw-r--r--@</span> 1 vikram  staff   157K Jun  7 18:28 colleges.csv</span></code></pre></div>
<ul>
<li><p>The <code>README.md</code> file contains metadata and other details for the information stored inside <code>colleges.csv</code>.</p></li>
<li><p>Use the <code>read_csv</code> function to import the data into R. Make sure to use the tidyverse function, which has an <code>_</code> instead of the base-R <code>.</code>.</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>college &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;colleges.csv&quot;</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a>── Column specification ──────────────────</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">cols</span>(</span>
<span id="cb3-8"><a href="#cb3-8"></a>  <span class="dt">date =</span> <span class="kw">col_date</span>(<span class="dt">format =</span> <span class="st">&quot;&quot;</span>),</span>
<span id="cb3-9"><a href="#cb3-9"></a>  <span class="dt">state =</span> <span class="kw">col_character</span>(),</span>
<span id="cb3-10"><a href="#cb3-10"></a>  <span class="dt">county =</span> <span class="kw">col_character</span>(),</span>
<span id="cb3-11"><a href="#cb3-11"></a>  <span class="dt">city =</span> <span class="kw">col_character</span>(),</span>
<span id="cb3-12"><a href="#cb3-12"></a>  <span class="dt">ipeds_id =</span> <span class="kw">col_character</span>(),</span>
<span id="cb3-13"><a href="#cb3-13"></a>  <span class="dt">college =</span> <span class="kw">col_character</span>(),</span>
<span id="cb3-14"><a href="#cb3-14"></a>  <span class="dt">cases =</span> <span class="kw">col_double</span>(),</span>
<span id="cb3-15"><a href="#cb3-15"></a>  <span class="dt">cases_2021 =</span> <span class="kw">col_double</span>(),</span>
<span id="cb3-16"><a href="#cb3-16"></a>  <span class="dt">notes =</span> <span class="kw">col_character</span>()</span>
<span id="cb3-17"><a href="#cb3-17"></a>)</span></code></pre></div>
<ul>
<li><p>You will notice that unlike the base-R function, <code>read_csv</code> tells you how it has interpreted data in each of the columns. There are several types of identifiers here as follows:</p>
<ul>
<li><p><code>col_date</code></p></li>
<li><p><code>col_character</code></p></li>
<li><p><code>col_double</code></p></li>
</ul></li>
<li><p>These are data type specifications implemented by <code>readr</code>. For example, the column with <code>date</code> header is being correctly identified as date time data. Information in column <code>state</code> is being read correctly as characters, and finally number of cases (<code>cases</code>) is being read as double, which is a type of numerical data.</p></li>
<li><p>Let’s now check what our data looks like:</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>college</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># A tibble: 1,948 x 9</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>   date       state  county  city   ipeds_id college      cases cases_<span class="dv">2021</span> notes</span>
<span id="cb4-5"><a href="#cb4-5"></a>   <span class="op">&lt;</span>date<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">        </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">      </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="st"> </span><span class="dv">1</span> <span class="dv">2021-05-26</span> Alaba… Madison Hunts… <span class="dv">100654</span>   Alabama A<span class="op">&amp;</span>M…    <span class="dv">41</span>         <span class="ot">NA</span> <span class="ot">NA</span>   </span>
<span id="cb4-7"><a href="#cb4-7"></a> <span class="dv">2</span> <span class="dv">2021-05-26</span> Alaba… Montgo… Montg… <span class="dv">100724</span>   Alabama Sta…     <span class="dv">2</span>         <span class="ot">NA</span> <span class="ot">NA</span>   </span>
<span id="cb4-8"><a href="#cb4-8"></a> <span class="dv">3</span> <span class="dv">2021-05-26</span> Alaba… Limest… Athens <span class="dv">100812</span>   Athens Stat…    <span class="dv">45</span>         <span class="dv">10</span> <span class="ot">NA</span>   </span>
<span id="cb4-9"><a href="#cb4-9"></a> <span class="dv">4</span> <span class="dv">2021-05-26</span> Alaba… Lee     Auburn <span class="dv">100858</span>   Auburn Univ…  <span class="dv">2742</span>        <span class="dv">567</span> <span class="ot">NA</span>   </span>
<span id="cb4-10"><a href="#cb4-10"></a> <span class="dv">5</span> <span class="dv">2021-05-26</span> Alaba… Montgo… Montg… <span class="dv">100830</span>   Auburn Univ…   <span class="dv">220</span>         <span class="dv">80</span> <span class="ot">NA</span>   </span>
<span id="cb4-11"><a href="#cb4-11"></a> <span class="dv">6</span> <span class="dv">2021-05-26</span> Alaba… Walker  Jasper <span class="dv">102429</span>   Bevill Stat…     <span class="dv">4</span>         <span class="ot">NA</span> <span class="ot">NA</span>   </span>
<span id="cb4-12"><a href="#cb4-12"></a> <span class="dv">7</span> <span class="dv">2021-05-26</span> Alaba… Jeffer… Birmi… <span class="dv">100937</span>   Birmingham<span class="op">-</span>…   <span class="dv">263</span>         <span class="dv">49</span> <span class="ot">NA</span>   </span>
<span id="cb4-13"><a href="#cb4-13"></a> <span class="dv">8</span> <span class="dv">2021-05-26</span> Alaba… Limest… Tanner <span class="dv">101514</span>   Calhoun Com…   <span class="dv">137</span>         <span class="dv">53</span> <span class="ot">NA</span>   </span>
<span id="cb4-14"><a href="#cb4-14"></a> <span class="dv">9</span> <span class="dv">2021-05-26</span> Alaba… Tallap… Alexa… <span class="dv">100760</span>   Central Ala…    <span class="dv">49</span>         <span class="dv">10</span> <span class="ot">NA</span>   </span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="dv">10</span> <span class="dv">2021-05-26</span> Alaba… Coffee  Enter… <span class="dv">101143</span>   Enterprise …    <span class="dv">76</span>         <span class="dv">35</span> <span class="ot">NA</span>   </span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co"># … with 1,938 more rows</span></span></code></pre></div>
<ul>
<li><p>As you will notice, readr has converted this data frame into a tibble, and it shows some useful information about the file instead of just spitting out all columns and all rows to the screen. Below each column header, a tibble identifies the type of data contained within it (enclosed within <code>&lt;&gt;</code>).</p></li>
<li><p>A tibble will always print the first 10 rows of data unless you ask for more. Depending upon the number of columns available in the data, it will also show only as many as it can comfortably fit on screen.</p></li>
</ul>
<p><br><br></p>
<h2 id="exploring-data">4. Exploring Data</h2>
<p><br></p>
<h3 id="using-pipes">4.1 Using Pipes</h3>
<ul>
<li><p>If you are familiar with the pipe function in Unix (<code>|</code>), the R pipe works similarly (albeit it uses a different symbol). The goal is to use output from one command and pass it onto another function. Just like the Unix pipe, the R pipe can also be nested as many times as you want. We will see some examples below.</p></li>
<li><p>What if you wanted to print 15 rows of data from the above tibble to the screen?</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>college <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>(<span class="dt">n=</span><span class="dv">15</span>, <span class="dt">width=</span><span class="ot">Inf</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># A tibble: 1,948 x 9</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>   date       state   county     city           ipeds_id college                              cases cases_<span class="dv">2021</span> notes</span>
<span id="cb5-5"><a href="#cb5-5"></a>   <span class="op">&lt;</span>date<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">      </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">          </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                                </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">      </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="st"> </span><span class="dv">1</span> <span class="dv">2021-05-26</span> Alabama Madison    Huntsville     <span class="dv">100654</span>   Alabama A<span class="op">&amp;</span>M University                  <span class="dv">41</span>         <span class="ot">NA</span> <span class="ot">NA</span>   </span>
<span id="cb5-7"><a href="#cb5-7"></a> <span class="dv">2</span> <span class="dv">2021-05-26</span> Alabama Montgomery Montgomery     <span class="dv">100724</span>   Alabama State University                 <span class="dv">2</span>         <span class="ot">NA</span> <span class="ot">NA</span>   </span>
<span id="cb5-8"><a href="#cb5-8"></a> <span class="dv">3</span> <span class="dv">2021-05-26</span> Alabama Limestone  Athens         <span class="dv">100812</span>   Athens State University                 <span class="dv">45</span>         <span class="dv">10</span> <span class="ot">NA</span>   </span>
<span id="cb5-9"><a href="#cb5-9"></a> <span class="dv">4</span> <span class="dv">2021-05-26</span> Alabama Lee        Auburn         <span class="dv">100858</span>   Auburn University                     <span class="dv">2742</span>        <span class="dv">567</span> <span class="ot">NA</span>   </span>
<span id="cb5-10"><a href="#cb5-10"></a> <span class="dv">5</span> <span class="dv">2021-05-26</span> Alabama Montgomery Montgomery     <span class="dv">100830</span>   Auburn University at Montgomery        <span class="dv">220</span>         <span class="dv">80</span> <span class="ot">NA</span>   </span>
<span id="cb5-11"><a href="#cb5-11"></a> <span class="dv">6</span> <span class="dv">2021-05-26</span> Alabama Walker     Jasper         <span class="dv">102429</span>   Bevill State Community College           <span class="dv">4</span>         <span class="ot">NA</span> <span class="ot">NA</span>   </span>
<span id="cb5-12"><a href="#cb5-12"></a> <span class="dv">7</span> <span class="dv">2021-05-26</span> Alabama Jefferson  Birmingham     <span class="dv">100937</span>   Birmingham<span class="op">-</span>Southern College            <span class="dv">263</span>         <span class="dv">49</span> <span class="ot">NA</span>   </span>
<span id="cb5-13"><a href="#cb5-13"></a> <span class="dv">8</span> <span class="dv">2021-05-26</span> Alabama Limestone  Tanner         <span class="dv">101514</span>   Calhoun Community College              <span class="dv">137</span>         <span class="dv">53</span> <span class="ot">NA</span>   </span>
<span id="cb5-14"><a href="#cb5-14"></a> <span class="dv">9</span> <span class="dv">2021-05-26</span> Alabama Tallapoosa Alexander City <span class="dv">100760</span>   Central Alabama Community College       <span class="dv">49</span>         <span class="dv">10</span> <span class="ot">NA</span>   </span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="dv">10</span> <span class="dv">2021-05-26</span> Alabama Coffee     Enterprise     <span class="dv">101143</span>   Enterprise State Community College      <span class="dv">76</span>         <span class="dv">35</span> <span class="ot">NA</span>   </span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="dv">11</span> <span class="dv">2021-05-26</span> Alabama Etowah     Gadsden        <span class="dv">101240</span>   Gadsden State Community College         <span class="dv">67</span>          <span class="dv">5</span> <span class="ot">NA</span>   </span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="dv">12</span> <span class="dv">2021-05-26</span> Alabama Montgomery Montgomery     <span class="dv">101435</span>   Huntingdon College                       <span class="dv">0</span>         <span class="ot">NA</span> <span class="ot">NA</span>   </span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="dv">13</span> <span class="dv">2021-05-26</span> Alabama Calhoun    Jacksonville   <span class="dv">101480</span>   Jacksonville State University          <span class="dv">229</span>         <span class="dv">10</span> <span class="ot">NA</span>   </span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="dv">14</span> <span class="dv">2021-05-26</span> Alabama Covington  Andalusia      <span class="dv">101602</span>   Lurleen B. Wallace Community College    <span class="dv">19</span>         <span class="ot">NA</span> <span class="ot">NA</span>   </span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="dv">15</span> <span class="dv">2021-05-26</span> Alabama Perry      Marion         <span class="dv">101648</span>   Marion Military Institute               <span class="dv">45</span>         <span class="dv">19</span> <span class="ot">NA</span>   </span></code></pre></div>
<ul>
<li>In the example above, we used <code>Inf</code> option for the width of the tibble. Because this tibble is small, it fits comfortable on our screen. However, if your tibble was much wider than this, you could restrict the width to match that of your display. For example, try the following three commands and try to notice the differences between the three outputs:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>college <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>(<span class="dt">n=</span><span class="dv">15</span>, <span class="dt">width=</span><span class="dv">150</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>college <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>(<span class="dt">n=</span><span class="dv">15</span>, <span class="dt">width=</span><span class="dv">100</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a>college <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>(<span class="dt">n=</span><span class="dv">15</span>, <span class="dt">width=</span><span class="dv">70</span>)</span></code></pre></div>
<ul>
<li><p>What was different about the outputs?</p></li>
<li><p>If you wanted to find out how many different institutions have been represented in this data set:</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>college <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(college)</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># A tibble: 1,936 x 2</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>   college                                                                     n</span>
<span id="cb7-5"><a href="#cb7-5"></a>   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">                                                                   </span><span class="er">&lt;</span>int<span class="op">&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="st"> </span><span class="dv">1</span> Abilene Christian University                                                <span class="dv">1</span></span>
<span id="cb7-7"><a href="#cb7-7"></a> <span class="dv">2</span> Abraham Baldwin Agricultural College                                        <span class="dv">1</span></span>
<span id="cb7-8"><a href="#cb7-8"></a> <span class="dv">3</span> Academy of Art University                                                   <span class="dv">1</span></span>
<span id="cb7-9"><a href="#cb7-9"></a> <span class="dv">4</span> Adams State University                                                      <span class="dv">1</span></span>
<span id="cb7-10"><a href="#cb7-10"></a> <span class="dv">5</span> Adelphi University                                                          <span class="dv">1</span></span>
<span id="cb7-11"><a href="#cb7-11"></a> <span class="dv">6</span> Adirondack Community College                                                <span class="dv">1</span></span>
<span id="cb7-12"><a href="#cb7-12"></a> <span class="dv">7</span> Adrian College                                                              <span class="dv">1</span></span>
<span id="cb7-13"><a href="#cb7-13"></a> <span class="dv">8</span> AdventHealth University                                                     <span class="dv">1</span></span>
<span id="cb7-14"><a href="#cb7-14"></a> <span class="dv">9</span> Agnes Scott College                                                         <span class="dv">1</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="dv">10</span> Air Force Institute of Technology<span class="op">-</span>Graduate School of Engineering <span class="op">&amp;</span><span class="st"> </span>Man…     <span class="dv">1</span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co"># … with 1,926 more rows</span></span></code></pre></div>
<p>This shows that there are a total of 1936 institutions covered here. <code>count</code> is a function from the library <code>dplyr</code>, part of core Tidyverse. The pipe (<code>%&gt;%</code>) is not part of tidyverse; it comes from a package named <code>magritter</code> which is a dependency for tidyverse.</p>
<p><Br><br></p>
<h3 id="accessing-specific-data-from-tibbles">4.2 Accessing Specific Data from Tibbles</h3>
<ul>
<li>Let’s say we wish to access data from Nevada.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>college <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="dt">state=</span><span class="st">&quot;Nevada&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># A tibble: 7 x 9</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  date       state  county      city        ipeds_id college                           cases cases_<span class="dv">2021</span> notes</span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="op">&lt;</span>date<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">       </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">       </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                             </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">      </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="dv">1</span> <span class="dv">2021-05-26</span> Nevada Clark       Las Vegas   <span class="dv">182005</span>   College of Southern Nevada          <span class="dv">440</span>        <span class="dv">111</span> <span class="ot">NA</span>   </span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="dv">2</span> <span class="dv">2021-05-26</span> Nevada Elko        Elko        <span class="dv">182306</span>   Great Basin College                  <span class="dv">43</span>          <span class="dv">9</span> <span class="ot">NA</span>   </span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="dv">3</span> <span class="dv">2021-05-26</span> Nevada Clark       Henderson   <span class="dv">441900</span>   Nevada State College                 <span class="dv">48</span>         <span class="dv">10</span> <span class="ot">NA</span>   </span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="dv">4</span> <span class="dv">2021-05-26</span> Nevada Washoe      Reno        <span class="dv">182500</span>   Truckee Meadows Community College    <span class="dv">58</span>         <span class="dv">10</span> <span class="ot">NA</span>   </span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="dv">5</span> <span class="dv">2021-05-26</span> Nevada Clark       Las Vegas   <span class="dv">182281</span>   University of Nevada, Las Vegas     <span class="dv">719</span>        <span class="dv">212</span> <span class="ot">NA</span>   </span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="dv">6</span> <span class="dv">2021-05-26</span> Nevada Washoe      Reno        <span class="dv">182290</span>   University of Nevada, Reno         <span class="dv">1544</span>        <span class="dv">335</span> <span class="ot">NA</span>   </span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="dv">7</span> <span class="dv">2021-05-26</span> Nevada Carson City Carson City <span class="dv">182564</span>   Western Nevada College               <span class="dv">53</span>          <span class="dv">4</span> <span class="ot">NA</span>   </span></code></pre></div>
<ul>
<li>What if you want to print 20 rows of data from Nevada?</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>college <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="dt">state=</span><span class="st">&quot;Nevada&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>(<span class="dt">n=</span><span class="dv">20</span>)</span></code></pre></div>
<ul>
<li>You will notice that only 7 rows are printed still. This is because there is probably not more data for Nevada. Try the same command on Texas:</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>college <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="dt">state=</span><span class="st">&quot;Texas) %&gt;% print(n=20)</span></span></code></pre></div>
<ul>
<li>What if you only want to print the following columns from Hawaii: date, state, county and cases?</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>college <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="dt">state=</span><span class="st">&quot;Hawaii&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co"># A tibble: 9 x 4</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  date       state  county   cases</span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="op">&lt;</span>date<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="dv">1</span> <span class="dv">2021-05-26</span> Hawaii Honolulu    <span class="dv">55</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="dv">2</span> <span class="dv">2021-05-26</span> Hawaii Honolulu     <span class="dv">1</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="dv">3</span> <span class="dv">2021-05-26</span> Hawaii Honolulu     <span class="dv">1</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="dv">4</span> <span class="dv">2021-05-26</span> Hawaii Honolulu     <span class="dv">5</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="dv">5</span> <span class="dv">2021-05-26</span> Hawaii Honolulu     <span class="dv">4</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="dv">6</span> <span class="dv">2021-05-26</span> Hawaii Maui         <span class="dv">2</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="dv">7</span> <span class="dv">2021-05-26</span> Hawaii Hawaii      <span class="dv">10</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="dv">8</span> <span class="dv">2021-05-26</span> Hawaii Honolulu    <span class="dv">73</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="dv">9</span> <span class="dv">2021-05-26</span> Hawaii Honolulu     <span class="dv">2</span></span></code></pre></div>
<ul>
<li>Notice that we used column numbers above instead of their names. But of course, you could achieve the same result using names:</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>college <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(state<span class="op">==</span><span class="st">&quot;Hawaii&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;state&quot;</span>, <span class="st">&quot;county&quot;</span>, <span class="st">&quot;cases&quot;</span>)</span></code></pre></div>
<ul>
<li>Repeat the last command with California:</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>col <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(state<span class="op">==</span><span class="st">&quot;California&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;state&quot;</span>, <span class="st">&quot;county&quot;</span>, <span class="st">&quot;cases&quot;</span>) </span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co"># A tibble: 90 x 4</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>   date       state      county          cases</span>
<span id="cb13-4"><a href="#cb13-4"></a>   <span class="op">&lt;</span>date<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">      </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">           </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="st"> </span><span class="dv">1</span> <span class="dv">2021-05-26</span> California San Francisco       <span class="dv">0</span></span>
<span id="cb13-6"><a href="#cb13-6"></a> <span class="dv">2</span> <span class="dv">2021-05-26</span> California Los Angeles       <span class="dv">101</span></span>
<span id="cb13-7"><a href="#cb13-7"></a> <span class="dv">3</span> <span class="dv">2021-05-26</span> California Los Angeles       <span class="dv">108</span></span>
<span id="cb13-8"><a href="#cb13-8"></a> <span class="dv">4</span> <span class="dv">2021-05-26</span> California Kern                <span class="dv">0</span></span>
<span id="cb13-9"><a href="#cb13-9"></a> <span class="dv">5</span> <span class="dv">2021-05-26</span> California Los Angeles        <span class="dv">99</span></span>
<span id="cb13-10"><a href="#cb13-10"></a> <span class="dv">6</span> <span class="dv">2021-05-26</span> California Riverside          <span class="dv">25</span></span>
<span id="cb13-11"><a href="#cb13-11"></a> <span class="dv">7</span> <span class="dv">2021-05-26</span> California Los Angeles       <span class="dv">123</span></span>
<span id="cb13-12"><a href="#cb13-12"></a> <span class="dv">8</span> <span class="dv">2021-05-26</span> California Ventura            <span class="dv">47</span></span>
<span id="cb13-13"><a href="#cb13-13"></a> <span class="dv">9</span> <span class="dv">2021-05-26</span> California San Luis Obispo  <span class="dv">2021</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="dv">10</span> <span class="dv">2021-05-26</span> California Los Angeles        <span class="dv">61</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co"># … with 80 more rows</span></span></code></pre></div>
<ul>
<li><p>California data consists of 90 rows altogether.</p></li>
<li><p>You have just used two new functions from the <code>dplyr</code> package. If you are curious about details of these functions, you can always look at the package help menu:</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>?filter</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a>Help on topic ‘filter’ was found <span class="cf">in</span> the following packages<span class="op">:</span></span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="st">  </span>Package               Library</span>
<span id="cb14-6"><a href="#cb14-6"></a>  dplyr                 <span class="op">/</span>Library<span class="op">/</span>Frameworks<span class="op">/</span>R.framework<span class="op">/</span>Versions<span class="op">/</span><span class="fl">4.0</span><span class="op">/</span>Resources<span class="op">/</span>library</span>
<span id="cb14-7"><a href="#cb14-7"></a>  stats                 <span class="op">/</span>Library<span class="op">/</span>Frameworks<span class="op">/</span>R.framework<span class="op">/</span>Versions<span class="op">/</span><span class="fl">4.0</span><span class="op">/</span>Resources<span class="op">/</span>library</span></code></pre></div>
<ul>
<li>As you see above, sometimes same function names are used in multiple packages. To choose the correct one, be more explicit as follows:</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>?dplyr<span class="op">::</span>filter</span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a>?dplyr<span class="op">::</span>select</span></code></pre></div>
<p><Br><br></p>
<h3 id="exploratory-visualization">4.3 Exploratory Visualization</h3>
<ul>
<li>Pipes make it very easy to subset data and plot it on the fly without creating any additional objects. This functionality is rather useful when exploring the data.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>col <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(state<span class="op">==</span><span class="st">&quot;California&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;state&quot;</span>, <span class="st">&quot;county&quot;</span>, <span class="st">&quot;cases&quot;</span>)  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>date, <span class="dt">y=</span>cases))</span></code></pre></div>
<center>
<img src="ca_college_hist.png" width=550> </img>
</center>
<ul>
<li>The data that we are currently exploring is rather limited. Let’s bring in a larger data set.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">setwd</span>(<span class="st">&quot;../covid-19-data&quot;</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="kw">list.files</span>()</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a> [<span class="dv">1</span>] <span class="st">&quot;colleges&quot;</span>                       <span class="st">&quot;excess-deaths&quot;</span>                  <span class="st">&quot;LICENSE&quot;</span>                        <span class="st">&quot;live&quot;</span>                          </span>
<span id="cb17-6"><a href="#cb17-6"></a> [<span class="dv">5</span>] <span class="st">&quot;mask-use&quot;</span>                       <span class="st">&quot;NEW-YORK-DEATHS-METHODOLOGY.md&quot;</span> <span class="st">&quot;prisons&quot;</span>                        <span class="st">&quot;PROBABLE-CASES-NOTE.md&quot;</span>        </span>
<span id="cb17-7"><a href="#cb17-7"></a> [<span class="dv">9</span>] <span class="st">&quot;README.md&quot;</span>                      <span class="st">&quot;rolling-averages&quot;</span>               <span class="st">&quot;us-counties-recent.csv&quot;</span>         <span class="st">&quot;us-counties.csv&quot;</span>               </span>
<span id="cb17-8"><a href="#cb17-8"></a>[<span class="dv">13</span>] <span class="st">&quot;us-states.csv&quot;</span>                  <span class="st">&quot;us.csv&quot;</span> </span></code></pre></div>
<ul>
<li>Bring in the US counties data set</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>counties &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;us-counties.csv&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a></span>
<span id="cb18-3"><a href="#cb18-3"></a>counties</span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co"># A tibble: 1,394,421 x 6</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>   date       county      state      fips  cases deaths</span>
<span id="cb18-7"><a href="#cb18-7"></a>   <span class="op">&lt;</span>date<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">       </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">      </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="st"> </span><span class="dv">1</span> <span class="dv">2020-01-21</span> Snohomish   Washington <span class="dv">53061</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb18-9"><a href="#cb18-9"></a> <span class="dv">2</span> <span class="dv">2020-01-22</span> Snohomish   Washington <span class="dv">53061</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb18-10"><a href="#cb18-10"></a> <span class="dv">3</span> <span class="dv">2020-01-23</span> Snohomish   Washington <span class="dv">53061</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb18-11"><a href="#cb18-11"></a> <span class="dv">4</span> <span class="dv">2020-01-24</span> Cook        Illinois   <span class="dv">17031</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb18-12"><a href="#cb18-12"></a> <span class="dv">5</span> <span class="dv">2020-01-24</span> Snohomish   Washington <span class="dv">53061</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb18-13"><a href="#cb18-13"></a> <span class="dv">6</span> <span class="dv">2020-01-25</span> Orange      California <span class="dv">06059</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb18-14"><a href="#cb18-14"></a> <span class="dv">7</span> <span class="dv">2020-01-25</span> Cook        Illinois   <span class="dv">17031</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb18-15"><a href="#cb18-15"></a> <span class="dv">8</span> <span class="dv">2020-01-25</span> Snohomish   Washington <span class="dv">53061</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb18-16"><a href="#cb18-16"></a> <span class="dv">9</span> <span class="dv">2020-01-26</span> Maricopa    Arizona    <span class="dv">04013</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="dv">10</span> <span class="dv">2020-01-26</span> Los Angeles California <span class="dv">06037</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="co"># … with 1,394,411 more rows</span></span></code></pre></div>
<ul>
<li>This consists of data from the beginning of the pandemic up until very recent. Just to get a handle on the range of dates for which this data is available, do this:</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">range</span>(counties<span class="op">$</span>date)</span>
<span id="cb19-2"><a href="#cb19-2"></a>[<span class="dv">1</span>] <span class="st">&quot;2020-01-21&quot;</span> <span class="st">&quot;2021-06-06&quot;</span></span></code></pre></div>
<ul>
<li>Let’s subset the data for the state of California again</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>counties <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(state<span class="op">==</span><span class="st">&quot;California&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co"># A tibble: 25,907 x 6</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>   date       county      state      fips  cases deaths</span>
<span id="cb20-5"><a href="#cb20-5"></a>   <span class="op">&lt;</span>date<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">       </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">      </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="st"> </span><span class="dv">1</span> <span class="dv">2020-01-25</span> Orange      California <span class="dv">06059</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb20-7"><a href="#cb20-7"></a> <span class="dv">2</span> <span class="dv">2020-01-26</span> Los Angeles California <span class="dv">06037</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb20-8"><a href="#cb20-8"></a> <span class="dv">3</span> <span class="dv">2020-01-26</span> Orange      California <span class="dv">06059</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb20-9"><a href="#cb20-9"></a> <span class="dv">4</span> <span class="dv">2020-01-27</span> Los Angeles California <span class="dv">06037</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb20-10"><a href="#cb20-10"></a> <span class="dv">5</span> <span class="dv">2020-01-27</span> Orange      California <span class="dv">06059</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb20-11"><a href="#cb20-11"></a> <span class="dv">6</span> <span class="dv">2020-01-28</span> Los Angeles California <span class="dv">06037</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb20-12"><a href="#cb20-12"></a> <span class="dv">7</span> <span class="dv">2020-01-28</span> Orange      California <span class="dv">06059</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb20-13"><a href="#cb20-13"></a> <span class="dv">8</span> <span class="dv">2020-01-29</span> Los Angeles California <span class="dv">06037</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb20-14"><a href="#cb20-14"></a> <span class="dv">9</span> <span class="dv">2020-01-29</span> Orange      California <span class="dv">06059</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="dv">10</span> <span class="dv">2020-01-30</span> Los Angeles California <span class="dv">06037</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="co"># … with 25,897 more rows</span></span></code></pre></div>
<ul>
<li>Let’s plot the number of cases per county in California</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>counties <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(state <span class="op">==</span><span class="st"> &quot;California) %&gt;% ggplot() + geom_point(aes(x=fips, y=cases))</span></span></code></pre></div>
<center>
<img src="california_cases.png" width=550 />
</center>
<ul>
<li>It seems that one of the counties has disproportionately higher number of cases. How would we find out what county that is?</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>counties <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(state <span class="op">==</span><span class="st"> &quot;California&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(cases <span class="op">&gt;</span><span class="st"> </span><span class="dv">1200000</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co"># A tibble: 94 x 6</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>   date       county      state      fips    cases deaths</span>
<span id="cb22-5"><a href="#cb22-5"></a>   <span class="op">&lt;</span>date<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">       </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">      </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="st"> </span><span class="dv">1</span> <span class="dv">2021-03-05</span> Los Angeles California <span class="dv">06037</span> <span class="dv">1200764</span>  <span class="dv">21910</span></span>
<span id="cb22-7"><a href="#cb22-7"></a> <span class="dv">2</span> <span class="dv">2021-03-06</span> Los Angeles California <span class="dv">06037</span> <span class="dv">1202513</span>  <span class="dv">22008</span></span>
<span id="cb22-8"><a href="#cb22-8"></a> <span class="dv">3</span> <span class="dv">2021-03-07</span> Los Angeles California <span class="dv">06037</span> <span class="dv">1203799</span>  <span class="dv">22029</span></span>
<span id="cb22-9"><a href="#cb22-9"></a> <span class="dv">4</span> <span class="dv">2021-03-08</span> Los Angeles California <span class="dv">06037</span> <span class="dv">1204665</span>  <span class="dv">22041</span></span>
<span id="cb22-10"><a href="#cb22-10"></a> <span class="dv">5</span> <span class="dv">2021-03-09</span> Los Angeles California <span class="dv">06037</span> <span class="dv">1205924</span>  <span class="dv">22099</span></span>
<span id="cb22-11"><a href="#cb22-11"></a> <span class="dv">6</span> <span class="dv">2021-03-10</span> Los Angeles California <span class="dv">06037</span> <span class="dv">1207361</span>  <span class="dv">22213</span></span>
<span id="cb22-12"><a href="#cb22-12"></a> <span class="dv">7</span> <span class="dv">2021-03-11</span> Los Angeles California <span class="dv">06037</span> <span class="dv">1208672</span>  <span class="dv">22304</span></span>
<span id="cb22-13"><a href="#cb22-13"></a> <span class="dv">8</span> <span class="dv">2021-03-12</span> Los Angeles California <span class="dv">06037</span> <span class="dv">1208678</span>  <span class="dv">22304</span></span>
<span id="cb22-14"><a href="#cb22-14"></a> <span class="dv">9</span> <span class="dv">2021-03-13</span> Los Angeles California <span class="dv">06037</span> <span class="dv">1210286</span>  <span class="dv">22446</span></span>
<span id="cb22-15"><a href="#cb22-15"></a><span class="dv">10</span> <span class="dv">2021-03-14</span> Los Angeles California <span class="dv">06037</span> <span class="dv">1210920</span>  <span class="dv">22474</span></span>
<span id="cb22-16"><a href="#cb22-16"></a><span class="co"># … with 84 more rows</span></span></code></pre></div>
<ul>
<li>What do the numbers look like for deaths?</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>counties <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(state <span class="op">==</span><span class="st"> &quot;California&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>fips, <span class="dt">y=</span>deaths))</span></code></pre></div>
<center>
<img src="california_cases.png" width=550 />
</center>
<ul>
<li>A quick eyeballing points likely to the same county for largest number of deaths. Just to verify:</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>counties <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(state <span class="op">==</span><span class="st"> &quot;California&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(deaths <span class="op">&gt;</span><span class="st"> </span><span class="dv">10000</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co"># A tibble: 159 x 6</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>   date       county      state      fips   cases deaths</span>
<span id="cb24-5"><a href="#cb24-5"></a>   <span class="op">&lt;</span>date<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">       </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">      </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="st"> </span><span class="dv">1</span> <span class="dv">2020-12-30</span> Los Angeles California <span class="dv">06037</span> <span class="dv">756412</span>  <span class="dv">10056</span></span>
<span id="cb24-7"><a href="#cb24-7"></a> <span class="dv">2</span> <span class="dv">2020-12-31</span> Los Angeles California <span class="dv">06037</span> <span class="dv">770915</span>  <span class="dv">10345</span></span>
<span id="cb24-8"><a href="#cb24-8"></a> <span class="dv">3</span> <span class="dv">2021-01-01</span> Los Angeles California <span class="dv">06037</span> <span class="dv">790895</span>  <span class="dv">10552</span></span>
<span id="cb24-9"><a href="#cb24-9"></a> <span class="dv">4</span> <span class="dv">2021-01-02</span> Los Angeles California <span class="dv">06037</span> <span class="dv">806523</span>  <span class="dv">10682</span></span>
<span id="cb24-10"><a href="#cb24-10"></a> <span class="dv">5</span> <span class="dv">2021-01-03</span> Los Angeles California <span class="dv">06037</span> <span class="dv">818959</span>  <span class="dv">10773</span></span>
<span id="cb24-11"><a href="#cb24-11"></a> <span class="dv">6</span> <span class="dv">2021-01-04</span> Los Angeles California <span class="dv">06037</span> <span class="dv">827843</span>  <span class="dv">10850</span></span>
<span id="cb24-12"><a href="#cb24-12"></a> <span class="dv">7</span> <span class="dv">2021-01-05</span> Los Angeles California <span class="dv">06037</span> <span class="dv">840956</span>  <span class="dv">11071</span></span>
<span id="cb24-13"><a href="#cb24-13"></a> <span class="dv">8</span> <span class="dv">2021-01-06</span> Los Angeles California <span class="dv">06037</span> <span class="dv">852510</span>  <span class="dv">11328</span></span>
<span id="cb24-14"><a href="#cb24-14"></a> <span class="dv">9</span> <span class="dv">2021-01-07</span> Los Angeles California <span class="dv">06037</span> <span class="dv">871749</span>  <span class="dv">11545</span></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="dv">10</span> <span class="dv">2021-01-08</span> Los Angeles California <span class="dv">06037</span> <span class="dv">889787</span>  <span class="dv">11863</span></span>
<span id="cb24-16"><a href="#cb24-16"></a><span class="co"># … with 149 more rows</span></span></code></pre></div>
<ul>
<li>Now try to make the last two plots for your home state and find out which county had the highest number of cases and deaths. Report back on Slack channel with county name and associated numbers.</li>
</ul>
<p><br><br></p>
<h3 id="exercises">4.3 Exercises</h3>
<ol type="1">
<li><p>Access the <code>prisons/</code> directory within the NYT covid-19-data repository and import the <code>facilities.csv</code> data into R (store it as an object <code>fac</code>).</p></li>
<li><p>How many rows and columns of data is present in the facilities data set?</p></li>
<li><p>Use the pipe function to display only these columns: facility name, state, inmate cases, inmate deaths</p></li>
<li><p>Count the total number of prison facilities.</p></li>
<li><p>Count the number of facilities per state.</p></li>
<li><p>Using the <code>fac_sub</code> tibble make a scatterplot of inmate cases vs inmate deaths in ggplot.</p></li>
<li><p>Which state had the highest number of inmate cases or deaths?</p></li>
</ol>
<p><br><br></p>
<h3 id="visualizing-data-on-maps">4.5 Visualizing Data on Maps</h3>
<ul>
<li><p>First install the following two packages:</p>
<ul>
<li><p><code>maps</code></p></li>
<li><p><code>mapdata</code></p></li>
</ul></li>
<li><p>Load the packages</p></li>
<li><p>Create base USA map object</p></li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>usa &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&#39;usa&#39;</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a></span>
<span id="cb25-3"><a href="#cb25-3"></a>states &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&#39;state&#39;</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a></span>
<span id="cb25-5"><a href="#cb25-5"></a>usa_base &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>states) <span class="op">+</span><span class="st"> </span><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">fill=</span><span class="kw">I</span>(<span class="st">&#39;white&#39;</span>), <span class="dt">group=</span>group), <span class="dt">color=</span><span class="st">&#39;gray&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_fixed</span>(<span class="fl">1.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<ul>
<li>Print basic USA map to the screen</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>usa_base</span></code></pre></div>
<center>
<img src="usa_base.png" width=750 />
</center>
<ul>
<li>Add locations of the prison facilities to the map</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>usa_base <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data=</span>fac, <span class="kw">aes</span>(<span class="dt">x=</span>facility_lng, <span class="dt">y=</span>facility_lat), <span class="dt">color=</span><span class="st">&quot;darkgreen&quot;</span>, <span class="dt">cex=</span><span class="fl">0.5</span>, <span class="dt">alpha=</span><span class="dv">3</span><span class="op">/</span><span class="dv">10</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_fixed</span>(<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">130</span>, <span class="dv">-60</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">50</span>), <span class="dt">ratio=</span><span class="fl">1.3</span>)</span></code></pre></div>
<center>
<img src="usa_prison_facs.png" width=750 />
</center>
</body>
</html>
